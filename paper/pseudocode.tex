\documentclass{article}
\usepackage{amsmath}
\usepackage[linesnumbered,ruled]{algorithm2e}

\begin{document}
\begin{algorithm}
    \SetKwInOut{Input}{Input}
    \SetKwInOut{Output}{Output}

    \underline{function prediction\_aggregator} $(P, D)$\;
    \Input{Probability distribution over target categories of all images for one product $P$, product $D$}
    \Output{Category prediction of the product}
    \For{candidate \in cadidates\_pool } {
    	\For{image \in $imgaes_{D}$} {
    		calculate exclusive average and standard deviation of probability predictions of candidate category among all images except for current image;
    		
    		\eIf{$P(candidate | image)$ outside $95\%$ confidence interval} {
    			exclude the image;
    		}    		    		
    	}
    	update candidate score;
    }
    find winner with highest score;
    \caption{Belief-based Prediction Aggregation}
\end{algorithm}
\end{document} 